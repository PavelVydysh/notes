### 5.1. Form Login как альтернатива HTTP Basic

HTTP Basic удобен для начальных примеров, но неудобен для реальных приложений.
Form Login предоставляет HTML-форму для ввода имени пользователя и пароля.
Аутентификация происходит через отправку POST-запроса на /login.
После успешного входа Spring Security сохраняет пользователя в HttpSession, что исключает необходимость повторного ввода данных на каждый запрос.

### 5.2. Конфигурация Form Login
Базовая настройка:

```java
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    http
    .authorizeHttpRequests(auth -> auth
    .anyRequest().authenticated()
    )
    .formLogin(Customizer.withDefaults());  // включает стандартную форму
    
    return http.build();
}
```

По умолчанию:

- страница логина доступна по /login;
- успешный вход ведёт на корневой URL /;
- ошибка входа возвращает на /login?error.

### 5.3. Кастомизация Form Login
Можно указать собственные страницы и поведение:

```java
http.formLogin(form -> form
.loginPage("/my-login")           // собственная страница входа
.loginProcessingUrl("/process")   // эндпоинт обработки логина
.defaultSuccessUrl("/home", true) // куда перенаправлять при успехе
.failureUrl("/my-login?error=true")
);
```

Также поддерживаются AuthenticationSuccessHandler и AuthenticationFailureHandler для программного контроля над результатом аутентификации.

### 5.4. Сессии и управление ими
После успешного входа данные пользователя хранятся в SecurityContext, который привязан к HttpSession.

Основные настройки:

sessionCreationPolicy — политика создания сессий:
ALWAYS, NEVER, IF_REQUIRED, STATELESS;

защита от фиксации сессий (Session Fixation Protection) → Spring Security автоматически создаёт новую сессию после входа;

ограничение количества одновременных сессий для одного пользователя:
```java
http.sessionManagement(session -> session
.maximumSessions(1)
.expiredUrl("/session-expired")
);
```

### 5.5. Logout (выход)
Spring Security предоставляет автоматическую поддержку выхода:

URL /logout очищает SecurityContext и завершает сессию;

можно настроить поведение:
```java
http.logout(logout -> logout
.logoutUrl("/perform-logout")
.logoutSuccessUrl("/login?logout")
.invalidateHttpSession(true)
.deleteCookies("JSESSIONID")
);
```


### 5.6. Практические аспекты

- Form Login предпочтителен для пользовательских веб-приложений, где важен UI.
- Обеспечивает лучший UX по сравнению с HTTP Basic.
- Обязательно использовать HTTPS для передачи логина и пароля.
- При REST API чаще выбирают stateless-подход (JWT, OAuth2), а не хранение сессий.

Ключевые выводы главы

- Form Login — стандартный способ аутентификации через веб-форму.
- Spring Security автоматически управляет сессией и защищает её от фиксации.
- Конфигурация позволяет гибко настраивать страницы входа, перенаправления и обработку ошибок.
- Logout встроен и легко расширяется.
- Для REST API чаще применяют безсессионные подходы, но для классических веб-приложений Form Login остаётся базовым решением.