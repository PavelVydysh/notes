# Spring Data

Spring Data — это часть экосистемы Spring, предоставляющая абстракции для работы с различными источниками данных (SQL,
NoSQL, графовые БД и др.) с целью упростить доступ к данным и минимизировать шаблонный код.

Она позволяет взаимодействие с уровнем данных посредством абстракции, предоставляя конкретную реализацию
хранения данных под капотом, например Hibernate, MongoDB, Redis, JDBC и тд.

Технология реализует какую-то одну технологию хранения данных, поэтому нужно подключить конкретную реализацию для
использования Spring Data.

## Интерфейсы:

- Repository — наиболее абстрактный контракт. Если его расширить, прило
жение распознает интерфейс, написанный как любой репозиторий Spring
Data .Однако этот интерфейс не сможет унаследовать какие-либо предо
пределенные.операции (такие как создание записи, чтение всех записей или
чтение записи по первичному ключу)  В интерфейсе Repository не объявлен
ни один метод;


- CrudRepository — простейший контракт Spring Data, который, кроме всего
прочего, предоставляет некоторые функции по взаимодействию с сохра
ненными данными .Если его расширить, чтобы эти функции определить,
то станут доступны простейшие операции создания, чтения, изменения
и удаления записей;


- PagingAndSortingRepository — расширяет CrudRepository, добавляя опе
рации сортировки и чтения определенного количества записей (постра
нично)


Наиболее часто встречающий из узко специализируемых:

- JpaRepository — наиболее функциональный и удобный контракт Spring Data для работы с реляционными базами данных через JPA. 
Этот интерфейс расширяет PagingAndSortingRepository, а также добавляет дополнительные операции, специфичные для JPA. 
Он предоставляет расширенные возможности работы с коллекциями сущностей, включая массовое сохранение и удаление, 
а также методы для немедленного сохранения (с применением flush). Если расширить этот интерфейс, то станут доступны не только базовые 
CRUD-операции и постраничное чтение, но и более гибкие методы

Лучшая практика: 
Расширять интерфейс с необходимыми приложению возможностями.

## Особенности

- @Id - помечает поле в модели, как первичный ключ

- Spring Data может формировать запросы из названия метода, например:

```java
List<AccountEntity> findAccountEntityByName(String name);
```

Этот способ не стоит употреблять для промышленных приложений

- @Query позволяет писать собственные запросы:

```java
 @Query("SELECT * FROM account WHERE name = :name")
    List<Account> findAccountsByName(String name);
```

- @Modifying указывает, что будет выполняться операция изменения данных

Нужна, тк по умолчанию Spring Data ожидает SELECT

```java
@Modifying
@Transactional
@Query("UPDATE User u SET u.active = false WHERE u.lastLogin < :date")
int deactivateOldUsers(@Param("date") LocalDate date);
```